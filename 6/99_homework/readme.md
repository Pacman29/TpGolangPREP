Домашнее задание №6

Срок выполнения - 16 декабря 2017 (РК2)

Тема: работа с базой данных

----

Программа db_crud

Эта простой веб-сервис будет предствлять собой менеджер базы данных, который позволяет осуществлять CURD-запросы (create, read, update, delete) к ней по HTTP

В данном задании мы продолжаем отработку навыков работы с HTTP и взаимодействуем с базой данных.

Для пользователя это выглядит так:
* GET / - возвращает список все таблиц (которые мы можем использовать в дальнейших запросах)
* GET /$table?limit=5&offset=7 - возвращает список из 5 записей (limit) начиная с 7-й (offset) из таблицы $table. limit по-умолчанию 5, offset 0
* GET /$table/$id - возвращает информацию о самой записи или 404
* PUT /$table - создаёт новую запись, данный по записи в теле запроса (POST-параметры)
* POST /$table/$id - обновляет запись, данные приходят в теле запроса (POST-параметры)
* DELETE /$table/$id - удаляет запись

GET, PUT, POST, DELETE - это метод, которым был отправлен запрос

Особенности работы программы:
1. роутинг запросов - руками, никаких внешних роутов.
2. полная динамика. при инициализации в NewDbCRUD считываем из базы список таблиц, полей (запросы ниже), далее работаем с ними при валидации. Никакого хадкода в виде кучи условий и написанного кода для валидации-заполнения.
3. считаем что во время работы программы список таблиц не меняется
4. запросы придётся конструировать динамически, данные оттуда доставать тоже динамически - у вас нет фиксированного списка параметров - вы его подгружаете при инициализации.
5. Валидация на уровне "string - int - float - null", без заморочек. Помните, что json в пустой итнерфейс распаковывает как float (я надеюсь после рефлекта вы это уже не забудете).
6. Вся работа происходит через database/sql, вам на вход передаётся рабочее подключение к базе
7. Все имена полей так как они в базе.
8. В случае если возникает ошибка - просто возвращаем 500 в http-статусе

Запросы вам в помощь:
* SHOW TABLES;
* SHOW FULL COLUMNS FROM `$table_name`;
